<html>
<head>
	<title>Welcome home</title>
</head>
<body>
	<h1>Hello world</h1>


	<p>Send a message</p>
	<input id="messageInput" type="text"></input>
	<button id="sendMessageButton">Send</button>

	<ul id="messageList"></ul>
	
	
	<script>
		var wsEndpoint = "/chatsocket";

		var origin = document.location.origin;

		var wsUrl = "ws" + origin.substring(4) + wsEndpoint;



		var ws = new WebSocket(wsUrl);

		var messageInput = document.getElementById('messageInput');

		var sendMessage = function(){
			var message = messageInput.value;
			messageInput.value = '';

			ws.send(message);

		};

		ws.onopen = function(){
			ws.send("hello to the server");
		};

		ws.onmessage = function(response){
			var messageList = document.getElementById('messageList');
			var messageNode = document.createElement('li');
			messageNode.innerHTML = response.data;

			messageList.appendChild(messageNode);
		};

		var button = document.getElementById('sendMessageButton');

		button.addEventListener('click', sendMessage);

		messageInput.addEventListener('keydown', function (key) {
			// enter key.which is 13
			if (key.which === 13){
				sendMessage();
			}
		});

	</script>

</body>
</html>